# RxInfer: A Julia package for automated Bayesian inference on a factor graph with reactive message passing

| **Documentation**                                                               | **Build Status**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               - [**Introduction**](https://reactivebayes.github.io/RxInfer.io/stable/)
- [**Getting started**](https://reactivebayes.github.io/RxInfer.io/stable/manuals/getting-started/)
- [**Examples**](https://reactivebayes.github.io/RxInfer.io/stable/examples/overview/)
- [**Library**](https://reactivebayes.github.io/RxInfer.io/stable/library/overview/)

| **Chat**                                                                      | **Social**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              - [![Gitter](https://badges.gitter.im/RxInfer/community.svg)](https://gitter.im/RxInfer/community)
- [![Twitter Follow](https://img.shields.io/twitter/follow/RxInfer?style=social)](https://twitter.com/RxInfer)

[![Build Status](https://github.com/ReactiveBayes/RxInfer.jl/actions/workflows/CI.yml/badge.svg?branch=main)](https://github.com/ReactiveBayes/RxInfer.jl/actions/workflows/CI.yml?query=branch%3Amain)
[![codecov](https://codecov.io/gh/ReactiveBayes/RxInfer.jl/branch/main/graph/badge.svg?token=JBW2L8L05F)](https://codecov.io/gh/ReactiveBayes/RxInfer.jl)
[![Aqua QA](https://raw.githubusercontent.com/JuliaTesting/Aqua.jl/master/badge.svg)](https://github.com/JuliaTesting/Aqua.jl)
[![DOI](https://joss.theoj.org/papers/10.21105/joss.05231/status.svg)](https://doi.org/10.21105/joss.05231)

**RxInfer** is a Julia package for automated Bayesian inference on a factor graph with reactive message passing. It is designed for probabilistic models that can be represented as a Forney-style Factor Graph (FFG). The main goal of **RxInfer** is to provide an efficient, scalable and flexible tool for Bayesian inference. It combines the strengths of message passing-based inference with the flexibility of modern probabilistic programming. It allows for the specification of a model in a simple and intuitive way, and then automatically generates an efficient inference algorithm.

## Installation

**RxInfer** is a registered Julia package and can be installed with the Julia package manager:

```julia
using Pkg
Pkg.add("RxInfer")
```

## Example

Let's consider a simple example of a Gaussian linear model. We have a set of observations $y$ and we want to infer the posterior distribution of the parameters $\tau$ and $w$. The model is defined as follows:

$$
\begin{aligned}
    y_i &\sim \mathcal{N}(x_i^T w, \tau^{-1}) \\
    w_j &\sim \mathcal{N}(0, 1) \\
    \tau &\sim \text{Gamma}(1, 1)
\end{aligned}
$$

where $x_i$ are the features, $w$ are the weights and $\tau$ is the precision of the noise. We can define this model in **RxInfer** as follows:

```julia
using RxInfer

@model function linear_regression(n_features, n_samples)

    # Priors
    w ~ MvNormal(mean = zeros(n_features), precision = diageye(n_features))
    τ ~ Gamma(shape = 1.0, rate = 1.0)

    # Likelihood
    y = datavar(Float64, n_samples)
    x = datavar(Float64, n_samples, n_features)

    for i in 1:n_samples
        y[i] ~ Normal(mean = dot(x[i, :], w), precision = τ)
    end

end
```

Then we can generate some data and run the inference algorithm:

```julia
# Generate some data
n_features = 3
n_samples  = 1000

X = randn(n_samples, n_features)
w_real = randn(n_features)
y_real = X * w_real + 0.1 * randn(n_samples)

# Run inference
result = infer(
    model = linear_regression(n_features, n_samples),
    data  = (y = y_real, x = X)
)
```

After the inference is done, we can inspect the results:

```julia
# `result` is a dictionary with the posterior marginals
# for the random variables `w` and `τ`

# For example, we can get the posterior marginal for `w`
posterior_w = result.posteriors[:w]

# And we can get the mean and covariance of the posterior
mean(posterior_w)
cov(posterior_w)

# We can also plot the posterior marginals
using Plots

plot(posterior_w)
```

## Documentation

For more information, please refer to the [documentation](https://reactivebayes.github.io/RxInfer.jl/stable/).

## Contributing

**RxInfer** is an open-source project and we welcome contributions from the community. If you are interested in contributing, please read our [contributing guide](https://reactivebayes.github.io/RxInfer.jl/stable/contributing/guide/).

## Citing

If you use **RxInfer** in your research, please cite our paper:

```bibtex
@article{Bagaev2023,
  doi = {10.21105/joss.05231},
  url = {https://doi.org/10.21105/joss.05231},
  year = {2023},
  publisher = {The Open Journal},
  volume = {8},
  number = {85},
  pages = {5231},
  author = {Dmitry Bagaev and Albert Podusenko and Semen Budenny and Bert de Vries},
  title = {RxInfer: a Julia package for reactive message passing-based Bayesian inference},
  journal = {Journal of Open Source Software}
}
```

## License

**RxInfer** is licensed under the MIT License. See [LICENSE](https://github.com/ReactiveBayes/RxInfer.jl/blob/main/LICENSE) for more information.
